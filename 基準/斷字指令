#!/bin/bash
name=斷字
src=國語斷字文本.txt
trg=閩南語斷字文本.txt
lm_text=閩南語斷字模型.txt
test_text=斷字試驗文本.txt
result_text=moses試驗結果斷字.txt

src_text=${name}.${src}
trg_text=${name}.${trg}

cp ../語料/訓.華臺國語字斷字.txt ${src_text}
zcat ../語料/訓.例句國語字斷字.txt.gz >> ${src_text}
zcat ../語料/訓.華臺一對一斷字.txt.gz ../語料/訓.例句一對一斷字.txt.gz > ${trg_text}
cp ${trg_text} ${lm_text}
zcat ../語料/附錄句一對一斷字.txt.gz >> ${lm_text}
cp ../語料/試.華臺國語字斷字.txt ${test_text}
zcat ../語料/試.例句國語字斷字.txt.gz > ${test_text}

ngram-count -order 3 -interpolate -wbdiscount -unk -text ${lm_text} -lm ${lm_text}.lm
$SCRIPTS_ROOTDIR/training/train-model.perl -root-dir ${name} -corpus ${HOME}/git/huan1-ik8_gian5-kiu3/基準/${name} -f ${src} -e ${trg} -alignment grow-diag-final-and -reordering msd-bidirectional-fe -lm 0:3:${HOME}/git/huan1-ik8_gian5-kiu3/基準/${lm_text}.lm -external-bin-dir=${HOME}/mt/
moses -f ${name}/model/moses.ini < ${test_text} > ${result_text}
